local Players = game:GetService("Players")
local RunService = game:GetService("RunService")
local localPlayer = Players.LocalPlayer
local character = localPlayer.Character or localPlayer.CharacterAdded:Wait()
local humanoid = character:WaitForChild("Humanoid")
local humanoidRootPart = character:WaitForChild("HumanoidRootPart")
local mouse = localPlayer:GetMouse()

-- Dash variables
local dashSpeed = 100 -- How fast the dash is
local dashDuration = 0.2 -- How long the dash lasts
local dashCooldown = 1 -- Time between dashes
local isDashing = false

-- Fire trail effect
local function createFireTrail()
    if isDashing then
        -- Create a fire part behind the player
        local firePart = Instance.new("Part")
        firePart.Size = Vector3.new(2, 0.2, 2)
        firePart.CFrame = humanoidRootPart.CFrame * CFrame.new(0, -3, -3)  -- Position it slightly behind the player
        firePart.Anchored = true
        firePart.CanCollide = false
        firePart.Transparency = 1
        firePart.Parent = workspace

        -- Add fire effect
        local fire = Instance.new("Fire")
        fire.Heat = 10
        fire.Size = 5
        fire.Parent = firePart

        -- Clean up fire part after the dash duration
        game:GetService("Debris"):AddItem(firePart, dashDuration) -- Fire part will be removed after dashDuration
    end
end

-- Dash function
local function dash()
    if isDashing then return end
    isDashing = true

    -- Create BodyVelocity for dash movement
    local bodyVelocity = Instance.new("BodyVelocity")
    bodyVelocity.MaxForce = Vector3.new(100000, 100000, 100000)
    bodyVelocity.Velocity = humanoidRootPart.CFrame.LookVector * dashSpeed
    bodyVelocity.Parent = humanoidRootPart

    -- Create fire trail effect while dashing
    local startTime = tick()
    while tick() - startTime < dashDuration do
        createFireTrail()  -- Create the fire trail effect
        wait(0.1)  -- Repeat trail effect at regular intervals while dashing
    end

    -- Remove BodyVelocity after dashDuration
    bodyVelocity:Destroy()

    -- Cooldown before next dash
    wait(dashCooldown)
    isDashing = false
end

-- Detecting Q key press to trigger the dash
mouse.KeyDown:Connect(function(key)
    if key:lower() == "q" then
        dash()
    end
end)

-- Ensure the character is loaded and ready
localPlayer.CharacterAdded:Connect(function(newCharacter)
    character = newCharacter
    humanoid = character:WaitForChild("Humanoid")
    humanoidRootPart = character:WaitForChild("HumanoidRootPart")
end)
